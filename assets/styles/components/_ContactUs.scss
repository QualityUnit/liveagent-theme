/* stylelint-disable selector-class-pattern,
no-descending-specificity, scss/at-extend-no-missing-placeholder */
@use "../common/variables" as *;
@use "../common/mixins" as *;
@use "../elements/Typography" as *;
@forward "../elements/FakeChatButton";

$links: 8;
$minWidth: 15.125em;

$colors: (
	"green": $desaturated-green,
	"red": $desaturated-red,
	"violet": #efe6f8,
	"orange": $medium-orange,
);

.ContactUs {
	position: fixed;
	bottom: 1.125em;
	right: 1.125em;
	z-index: 999997;

	&__button {
		all: unset;
		position: relative;
		padding: 0.625em 1em 0.625em 1.5em;
		font-family: $font-secondary;
		font-weight: 600;
		color: $white;
		background: rgba($light-orange, 0);
		box-shadow: 0 0.25em 2em rgba($black-real, 0.12);
		border-radius: $border-radius-16;
		transition: all 0.35s;
		cursor: pointer;

		span {
			position: relative;
			z-index: 1;
		}

		&::before,
		&::after {
			content: "";

			@include posZero;
			position: absolute;
			border-radius: $border-radius-16;
			transition: all 0.35s;
		}

		&::before {
			background: var(--background);
			opacity: 1;
			z-index: 1;
		}

		&::after {
			background: $white;
			opacity: 0;
		}

		&.active {
			color: $black;

			&::before {

				opacity: 0;
			}

			&::after {
				opacity: 1;
			}

			.ContactUs__button--icon {
				fill: url(#Gradient) !important;

				&__wrap {

					&::after {
						background: rgba($white, 1);
					}
				}
			}
		}

		&--icon {

			@include square(2.5em);
			position: relative;
			z-index: 1;
			fill: $white !important;
			transition: fill 0.35s;

			&__wrap {
				position: relative;
				margin-left: 0.75em;
				border-radius: 50%;
				overflow: hidden;
				box-shadow: 0 0.25em 1em 0 rgba($black-real, 0.15);

				&::after {
					content: "";

					@include posZero;
					border-radius: 50%;
					position: absolute;
					background: rgba($white, 0);
					transition: all 0.35s;
				}
			}

			@media (min-width: $breakpoint-tablet) {

				@include square(3.5em);
			}
		}

		@media (hover: hover) {

			&:hover {
				background: rgba($light-orange, 1);
				color: $white;

				&::before,
				&::after {
					opacity: 0;
				}
			}

			&.active:hover {
				color: $white;

				.ContactUs__button--icon {
					fill: $white !important;

					&__wrap {

						&::after {
							background: transparent;
						}
					}
				}
			}
		}
	}

	&__form {
		position: fixed;
		bottom: 1.125em;
		left: 50%;
		z-index: 999998;
		padding: 1.5em;
		background-color: $white;
		border-radius: $border-radius-16;
		transform: translate(-50%, calc(100% + 1.125em));
		transition: transform 0.2s;
		width: 100%;

		&.visible {
			transform: translate(-50%, 0);
		}

		iframe {
			width: 100% !important;
			min-height: 35em;
		}

		@media (min-width: $breakpoint-tablet) {
			width: auto;
			left: auto;
			right: 1.125em;
			transform: translateY(calc(100% + 1.125em));

			&.visible {
				transform: translateY(0);
			}

			iframe {
				width: auto;
				min-width: 25em;
				min-height: 35em;
			}
		}

		.ContactUs__menu--close {
			opacity: 1;
			position: absolute;
			top: 0.75em;
			right: 0.75em;
		}
	}

	&__menu {
		min-width: $minWidth;
		padding-top: 1em;
		padding-bottom: 1em;
		margin-right: -0.75em;
		margin-bottom: -1em;
		overflow: hidden;

		&--wrap {
			position: absolute;
			bottom: calc(100% + 1em);
			right: 0;
			text-align: right;
			padding: 0.75em;
			transition: all 0.5s;
			transition-delay: $links * 0.15s;

			&::after {
				content: "";

				@include posZero;
				position: absolute;
				background-color: $white;
				border-radius: $border-radius-16;
				box-shadow: 0 0.25em 1.375em rgba($black-real, 0.12);
				z-index: -1;
				transform: scaleY(0);
				transform-origin: 50% bottom;
				transition: all 0.25s 0.35s;
			}

			&.visible {

				&::after {
					transform: scaleY(1);
					transition-delay: 0;
				}

				.ContactUs {

					&__menu {

						&--close,
						&--text {
							opacity: 1;
							transition: opacity 0.35s $links * 0.075s;
						}

						&--link {
							opacity: 1;
						}

						@for $i from 1 to $links {
							&--item:nth-of-type(#{$i}) .ContactUs__menu--link {
								transition-delay: ($links - $i) * 0.085 + s;
							}
						}
					}
				}
			}
		}

		&--item {
			margin-bottom: 0.625em;
		}

		&--link[class] {
			position: relative;
			display: flex;
			align-items: center;
			justify-content: flex-end;
			padding: 0.25em 1em 0.25em 0.25em;
			border-radius: $border-radius-16;
			font-weight: 600;
			font-family: $font-secondary;
			color: $black-real;
			opacity: 0;
			transition: all 0.25s 0.15s;
			z-index: 1;
			cursor: pointer;

			&::after {
				content: "";

				@include posZero;
				right: 0.75em;
				position: absolute;
				transform: translateX(calc(100% + 0.75em));
				transition: transform 0.2s;
				border-radius: $border-radius-16;
				z-index: -1;
			}

			&:hover {

				&::after {
					transform: translateX(0);
				}
			}

			@each $class, $color in $colors {
				&.#{$class} {

					&::after {

						background-color: $color;
					}
				}
			}

			@for $i from 1 to $links {
				.ContactUs__menu--item:nth-of-type(#{$i}) & {
					transition-delay: $i * 0.05 + s;
				}
			}

			&.chat[class] {

				.circleChatButtonWrap {

					transform: scale(0.6115);
					transform-origin: 0 0;

					position: relative;

					&::after {
						content: "";
						position: absolute;
						height: 100%;
						width: $minWidth;
						top: 0;
						right: 0;
					}

					@media (min-width: $breakpoint-tablet) {
						transform: scale(0.8615);
					}
				}

				> div[id] > div {

					@include square(3.5em);
					position: static !important;
				}
			}

			.fakeChatButton {

				&__msg {
					width: $minWidth * 1.33 - 1.5em;
				}
			}

			.ContactUs__icon,
			> div:not(.fakeChatButton) {

				@include square(2.5em);
				filter: drop-shadow(0 0.25em 1em rgba($black-real, 0.15));
				margin-left: 1em;

				@media (min-width: $breakpoint-tablet) {

					@include square(3.5em);
				}
			}
		}

		&--close {
			all: unset;

			@include appearance;
			margin-bottom: 1.5em;
			cursor: pointer;

			svg {

				@include square(1em);
			}
		}

		&--text {
			font-family: $font-secondary;
			font-size: 0.825rem;
			line-height: 1.5;
			margin-bottom: 0.75em;
		}

		&--close,
		&--text {
			opacity: 0;
			transition-delay: 0;
		}
	}
}
